要件
===

## 初期要件
ブラウザベースで矩形アノテーションツールのモックを作成したい。
目的は解説書から章タイトル、節タイトル、概要、本文、補足、コラム、用語解説、図、表を後に切り出したいためである。

次の機能を作成してほしい
- 矩形種別選択
- 矩形領域選択
- undo/redo機能
- 保存機能 (JSON形式でダウンロード)
- 画像の拡大縮小、移動表示機能

使い方
1. ブラウザを起動しベージへアクセス
2. 矩形種別を選択
3. 矩形領域を選択
    - 初回クリックで始点選択し、矩形選択状態になる
    - 二回目のクリックで終点選択し、矩形選択状態を解除
    - 終点選択中はどの領域を選択しているか半透明の矩形を描画して操作をわかりやすくしてほしい
4. 領域選択完了したらその領域を半透明で描画して欲しい
5. undo/redoボタンでやり直しができる
6. 矩形選択状態解除中は矩形種別を選択できるようにする
7. 画像領域でスクロールすると画像の拡大縮小をする
8. macのcommandキーを押しながらドラッグすると画像を水平移動して表示
9. 保存ボタンでアノテーションデータをJSONでダウンロード

補足
- 画像は左上原点とする
- 検証用なので画像はtest.png限定で良い。
- 保存はJSON形式。スキーマは次のとおり
- 矩形は枠線は不透明、領域は半透明で描画して欲しい


JSON例
```
{
    "image": "test.png"  // アノテーション対象画像
    "labels": {
        1: "章タイトル",
        2: "節タイトル",
        3: "概要",
        4: "本文",
        5: "補足",
        6: "コラム",
        7: "用語解説",
        8: "図"
        9: "表"
    },
    "annotation": [
        {
            "id": 1,  // ユニークID
            "label_id": 1,  // labelsの番号と対応している
            "polygon": [
                10, 10,  // x1 y1 (左上)
                20, 10,  // x2 y2 (右上)
                20, 20,  // x3 y3 (右下)
                10, 20,  // x4 y4 (左下)
            ]
        }, {
            "id": 2,
            "label_id": 3,
            "polygon": [
                100, 100,  // x1 y1 (左上)
                200, 100,  // x2 y2 (右上)
                200, 200,  // x3 y3 (右下)
                100, 200,  // x4 y4 (左下)
            ]
        }
    ]
}
```

## 追加要件1

機能を追加したい
1. モード選択 (矩形追加、矩形削除、矩形番号振り直し)
2. 矩形の削除機能
3. 矩形番号の振り直し

モード選択 (矩形追加、矩形削除、矩形番号振り直し)
次のボタンを追加し、モード切り替えができるようにしてほしい
- 矩形追加
  - 矩形追加機能は実像済み
- 矩形削除
  - 機能は新規追加
- 矩形番号振り直し
  - 機能は新規追加

矩形の削除機能
- 矩形削除ボタンを押すと矩形削除モードになる
- 未選択の矩形にマウスカーソルが当たると矩形が強調表示される
  - マウスカーソルが矩形から外れると強調表示は解除される
- 矩形をクリックすると矩形は削除対象となる
- 削除対象の矩形は強調表示される
- 削除ボタンを押すと削除対象の矩形は削除される
- キャンセルボタンを押すと編集をなかったことにする

矩形番号の振り直し
- 矩形番号振り直しボタンをクリックすると編集モードになる
- 未選択の矩形にマウスカーソルが当たると矩形が強調表示される
  - マウスカーソルが矩形から外れると強調表示は解除される
- 矩形をクリックするとその矩形のID(ユニーク番号)を割り当てる
- 再割り当て済みのの矩形は強調表示される
- 番号はインクリメントする
- OKボタンを押すと編集終了
  - 全矩形選択されていない場合警告を出す
  - 未選択の矩形領域を一瞬だけ強調表示して場所を特定しやすくする
- キャンセルボタンを押すと編集をなかったことにする
- 未選択の矩形領域を一瞬だけ強調表示して場所を特定しやすくするボタンを設置が欲しい

前提条件
矩形領域は重なりがないことを前提としている。
レイヤー等の概念は考慮しなくて良いものとする。
